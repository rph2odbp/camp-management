{"version":3,"file":"Tooltip.js","sources":["../../../../../src/components/internal/Tooltip/Tooltip.tsx"],"sourcesContent":["import { h } from 'preact';\nimport { useRef, useEffect, useState, useLayoutEffect } from 'preact/hooks';\nimport { createPortal } from 'preact/compat';\nimport cx from 'classnames';\nimport './Tooltip.scss';\nimport { TooltipPosition, TooltipProps } from './types';\n\n// 8px space between the target and the tooltip\nconst OFFSET = 8;\n\nexport function Tooltip(props: TooltipProps) {\n    const tooltipRef = useRef<HTMLDivElement>(null);\n    const [position, setPosition] = useState<TooltipPosition>('top');\n    const [isAnchorVisible, setIsAnchorVisible] = useState<boolean>(true);\n    const [style, setStyle] = useState({});\n\n    useLayoutEffect(() => {\n        if (!props?.visible || !props?.anchorRef?.current || !tooltipRef.current) return;\n\n        const updatePosition = () => {\n            const anchorEl = props.anchorRef.current;\n            const tooltipEl = tooltipRef.current;\n            const anchorRect = anchorEl.getBoundingClientRect();\n\n            const offsetTop = anchorRect.top + window.scrollY;\n            const offsetLeft = anchorRect.left + window.scrollX;\n            const spaceAbove = anchorRect.top;\n            const spaceBelow = window.innerHeight - anchorRect.bottom;\n\n            let newPosition: TooltipPosition;\n            if (spaceAbove >= tooltipEl.offsetHeight + OFFSET) {\n                newPosition = 'top';\n            } else if (spaceBelow >= tooltipEl.offsetHeight + OFFSET) {\n                newPosition = 'bottom';\n            } else {\n                newPosition = spaceBelow > spaceAbove ? 'bottom' : 'top';\n            }\n\n            const newStyle: any = {\n                position: 'absolute',\n                left: offsetLeft + anchorRect.width / 2,\n                transform: 'translateX(-50%)',\n                willChange: 'transform'\n            };\n            newStyle.top = newPosition === 'top' ? offsetTop - tooltipEl.offsetHeight - OFFSET : offsetTop + anchorRect.height + OFFSET;\n\n            setStyle(newStyle);\n            setPosition(newPosition);\n        };\n\n        // We need {capture: true}, if the tooltip is placed inside scrollable containers because:\n        // Scroll does not bubble. So if an element inside your page scrolls (like a <div> with overflow: scroll),\n        // and you attach a scroll listener on the window without capture: true, it wonâ€™t catch those inner scrolls.\n        window.addEventListener('scroll', updatePosition, { capture: true });\n        window.addEventListener('resize', updatePosition);\n\n        updatePosition();\n\n        return () => {\n            window.removeEventListener('scroll', updatePosition, { capture: true });\n            window.removeEventListener('resize', updatePosition);\n        };\n    }, [props?.visible, props?.anchorRef]);\n\n    // Hide the tooltip if it's not in the viewport.\n    useEffect(() => {\n        const anchor = props?.anchorRef?.current;\n        if (!anchor) return;\n\n        if ('IntersectionObserver' in window) {\n            const observer = new IntersectionObserver(\n                ([entry]) => {\n                    setIsAnchorVisible(entry.isIntersecting);\n                },\n                { threshold: 0.1 }\n            );\n            observer.observe(anchor);\n\n            return () => {\n                observer.disconnect();\n            };\n        }\n    }, [props?.anchorRef]);\n\n    return createPortal(\n        <div\n            id={props.id}\n            role=\"tooltip\"\n            aria-live={'polite'}\n            className={cx({\n                'adyen-checkout-tooltip': true,\n                'adyen-checkout-tooltip--hidden': !props.visible || !isAnchorVisible,\n                [`adyen-checkout-tooltip--${position}`]: true\n            })}\n            ref={tooltipRef}\n            style={style}\n        >\n            {props.text}\n            <div className={`adyen-checkout-tooltip-arrow adyen-checkout-tooltip-arrow--${position}`} />\n        </div>,\n        document.body\n    );\n}\n"],"names":["Tooltip","props","tooltipRef","useRef","position","setPosition","useState","isAnchorVisible","setIsAnchorVisible","style","setStyle","useLayoutEffect","visible","anchorRef","current","updatePosition","anchorEl","tooltipEl","anchorRect","getBoundingClientRect","offsetTop","top","window","scrollY","offsetLeft","left","scrollX","spaceAbove","spaceBelow","innerHeight","bottom","newPosition","offsetHeight","newStyle","width","transform","willChange","height","addEventListener","capture","removeEventListener","useEffect","anchor","observer","IntersectionObserver","entry","isIntersecting","threshold","observe","disconnect","createPortal","h","div","id","role","aria-live","className","cx","ref","text","document","body"],"mappings":"wTAUO,SAASA,EAAQC,GACpB,MAAMC,EAAaC,EAAuB,OACnCC,EAAUC,GAAeC,EAA0B,QACnDC,EAAiBC,GAAsBF,GAAkB,IACzDG,EAAOC,GAAYJ,EAAS,CAAA,GAsEnC,OApEAK,EAAgB,KACZ,IAAKV,GAAOW,UAAYX,GAAOY,WAAWC,UAAYZ,EAAWY,QAAS,OAE1E,MAAMC,EAAiB,KACnB,MAAMC,EAAWf,EAAMY,UAAUC,QAC3BG,EAAYf,EAAWY,QACvBI,EAAaF,EAASG,wBAEtBC,EAAYF,EAAWG,IAAMC,OAAOC,QACpCC,EAAaN,EAAWO,KAAOH,OAAOI,QACtCC,EAAaT,EAAWG,IACxBO,EAAaN,OAAOO,YAAcX,EAAWY,OAEnD,IAAIC,EAEAA,EADAJ,GAAcV,EAAUe,aAtBzB,EAuBe,MACPJ,GAAcX,EAAUe,aAxBhC,GA2BeJ,EAAaD,EAFb,SAEqC,MAGvD,MAAMM,EAAgB,CAClB7B,SAAU,WACVqB,KAAMD,EAAaN,EAAWgB,MAAQ,EACtCC,UAAW,mBACXC,WAAY,aAEhBH,EAASZ,IAAsB,QAAhBU,EAAwBX,EAAYH,EAAUe,aApC1D,EAoCkFZ,EAAYF,EAAWmB,OApCzG,EAsCH3B,EAASuB,GACT5B,EAAY0B,IAWhB,OALAT,OAAOgB,iBAAiB,SAAUvB,EAAgB,CAAEwB,SAAS,IAC7DjB,OAAOgB,iBAAiB,SAAUvB,GAElCA,IAEO,KACHO,OAAOkB,oBAAoB,SAAUzB,EAAgB,CAAEwB,SAAS,IAChEjB,OAAOkB,oBAAoB,SAAUzB,KAE1C,CAACd,GAAOW,QAASX,GAAOY,YAG3B4B,EAAU,KACN,MAAMC,EAASzC,GAAOY,WAAWC,QACjC,GAAK4B,GAED,yBAA0BpB,OAAQ,CAClC,MAAMqB,EAAW,IAAIC,qBACjB,EAAEC,MACErC,EAAmBqC,EAAMC,iBAE7B,CAAEC,UAAW,KAIjB,OAFAJ,EAASK,QAAQN,GAEV,KACHC,EAASM,aAEjB,GACD,CAAChD,GAAOY,YAEJqC,EACHC,EAACC,MAAAA,CACGC,GAAIpD,EAAMoD,GACVC,KAAK,UACLC,YAAW,SACXC,UAAWC,EAAG,CACV,0BAA0B,EAC1B,kCAAmCxD,EAAMW,UAAYL,EACrD,CAAC,2BAA2BH,MAAa,IAE7CsD,IAAKxD,EACLO,MAAOA,GAENR,EAAM0D,KACPR,EAACC,MAAAA,CAAII,UAAW,8DAA8DpD,OAElFwD,SAASC,KAEjB"}